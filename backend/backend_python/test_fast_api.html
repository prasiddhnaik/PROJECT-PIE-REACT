<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¡ Fast API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .title { color: #333; margin-bottom: 20px; }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn:hover { background: #0056b3; }
        .result {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        .success { border-left-color: #28a745; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        .fast { color: #28a745; font-weight: bold; }
        .slow { color: #dc3545; font-weight: bold; }
        input { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">âš¡ Fast Financial API Tester</h1>
        
        <div>
            <h3>ðŸ§ª Quick Tests</h3>
            <button class="btn" onclick="testHealth()">Health Check</button>
            <button class="btn" onclick="testQuick()">Quick Test</button>
            <button class="btn" onclick="testPopular()">Popular Stocks</button>
        </div>
        
        <div>
            <h3>ðŸ“Š Stock Lookup</h3>
            <input type="text" id="symbolInput" placeholder="Symbol (e.g., AAPL)" value="AAPL">
            <button class="btn" onclick="testStock()">Get Stock Data</button>
        </div>
        
        <div id="results"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000';
        
        function addResult(title, content, type = 'result') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = `<h4>${title}</h4><pre>${content}</pre>`;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }
        
        function formatTime(ms) {
            if (ms < 100) return `<span class="fast">${ms}ms</span>`;
            if (ms < 500) return `${ms}ms`;
            return `<span class="slow">${ms}ms</span>`;
        }
        
        async function testHealth() {
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                const time = Math.round(performance.now() - start);
                
                addResult('Health Check', 
                    `Status: ${data.status}\nResponse Time: ${formatTime(time)}`, 
                    'success');
            } catch (error) {
                const time = Math.round(performance.now() - start);
                addResult('Health Check Failed', 
                    `Error: ${error.message}\nTime: ${formatTime(time)}`, 
                    'error');
            }
        }
        
        async function testQuick() {
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE}/api/test/quick`);
                const data = await response.json();
                const time = Math.round(performance.now() - start);
                
                addResult('Quick Test', 
                    `Test: ${data.test}\nAPI Response Time: ${formatTime(data.response_time_ms)}\nTotal Time: ${formatTime(time)}\nSample Price: $${data.sample_data?.price || 'N/A'}`, 
                    data.test === 'passed' ? 'success' : 'error');
            } catch (error) {
                const time = Math.round(performance.now() - start);
                addResult('Quick Test Failed', 
                    `Error: ${error.message}\nTime: ${formatTime(time)}`, 
                    'error');
            }
        }
        
        async function testPopular() {
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE}/fast/popular`);
                const data = await response.json();
                const time = Math.round(performance.now() - start);
                
                let content = `Response Time: ${formatTime(data.response_time_ms)}\nTotal Time: ${formatTime(time)}\n\nStocks:\n`;
                for (const [symbol, stockData] of Object.entries(data.data)) {
                    content += `${symbol}: $${stockData.price} (${stockData.change >= 0 ? '+' : ''}${stockData.change})\n`;
                }
                
                addResult('Popular Stocks', content, 'success');
            } catch (error) {
                const time = Math.round(performance.now() - start);
                addResult('Popular Stocks Failed', 
                    `Error: ${error.message}\nTime: ${formatTime(time)}`, 
                    'error');
            }
        }
        
        async function testStock() {
            const symbol = document.getElementById('symbolInput').value.trim().toUpperCase();
            if (!symbol) return;
            
            const start = performance.now();
            try {
                const response = await fetch(`${API_BASE}/fast/stock/${symbol}`);
                const data = await response.json();
                const time = Math.round(performance.now() - start);
                
                if (data.success) {
                    const stock = data.data;
                    const content = `Symbol: ${stock.symbol}\nPrice: $${stock.price}\nChange: ${stock.change >= 0 ? '+' : ''}${stock.change}\nVolume: ${stock.volume?.toLocaleString() || 'N/A'}\nSource: ${stock.source}\n\nAPI Response Time: ${formatTime(data.response_time_ms)}\nTotal Time: ${formatTime(time)}\nCached: ${data.cached ? 'Yes' : 'No'}`;
                    
                    addResult(`Stock Data: ${symbol}`, content, 'success');
                } else {
                    addResult(`Stock Data Failed: ${symbol}`, 
                        `Error: ${data.error}\nTime: ${formatTime(time)}`, 
                        'error');
                }
            } catch (error) {
                const time = Math.round(performance.now() - start);
                addResult(`Stock Data Failed: ${symbol}`, 
                    `Error: ${error.message}\nTime: ${formatTime(time)}`, 
                    'error');
            }
        }
        
        // Allow Enter key
        document.getElementById('symbolInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') testStock();
        });
        
        // Auto-run health check on load
        window.addEventListener('load', () => {
            setTimeout(testHealth, 500);
        });
    </script>
</body>
</html> 